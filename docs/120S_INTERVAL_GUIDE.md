# PRISM 120ç§’é–“éš”è‡ªå‹•ä»•åˆ†ã‘ ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

## â° 120ç§’é–“éš”è¨­å®šå®Œäº†

**å®Ÿè¡Œé–“éš”**: 120ç§’ï¼ˆ2åˆ†ãŠãï¼‰  
**è¨­å®šæ–¹æ³•**: launchdï¼ˆmacOSæ¨å¥¨ï¼‰  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè¡Œä¸­

---

## ğŸš€ è¨­å®šæ–¹æ³•ï¼ˆ3ã¤ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

### æ–¹æ³•1: 120ç§’é–“éš”å°‚ç”¨è¨­å®šï¼ˆæ¨å¥¨ï¼‰

```bash
cd /Users/hal1956/development/PRISM
bash tools/setup_120s_interval.sh
```

**ç‰¹å¾´:**
- âœ… 120ç§’é–“éš”ã«æœ€é©åŒ–
- âœ… ã‚·ãƒ³ãƒ—ãƒ«ãªè¨­å®š
- âœ… å°‚ç”¨ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«

### æ–¹æ³•2: é–“éš”å¤‰æ›´ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```bash
cd /Users/hal1956/development/PRISM
bash tools/change_interval.sh
# â†’ ã€Œ2ã€ã‚’é¸æŠï¼ˆ120ç§’é–“éš”ï¼‰
```

**ç‰¹å¾´:**
- âœ… ä»–ã®é–“éš”ã«ã‚‚å¤‰æ›´å¯èƒ½
- âœ… å‹•çš„ãªé–“éš”å¤‰æ›´
- âœ… ç¾åœ¨ã®è¨­å®šç¢ºèª

### æ–¹æ³•3: cronç‰ˆï¼ˆä¸Šç´šè€…å‘ã‘ï¼‰

```bash
cd /Users/hal1956/development/PRISM
bash tools/setup_auto_classify_interval.sh
# â†’ ã€Œ1ã€ã‚’é¸æŠï¼ˆ120ç§’é–“éš”ï¼‰
```

---

## ğŸ“Š ç¾åœ¨ã®è¨­å®šç¢ºèª

### ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹

```bash
# launchdã‚µãƒ¼ãƒ“ã‚¹ç¢ºèª
launchctl list | grep prism

# å‡ºåŠ›ä¾‹:
# -	0	com.hovix.prism.classify.120s
```

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

```bash
# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€
ls -l ~/Library/LaunchAgents/com.hovix.prism.classify.120s.plist

# è¨­å®šå†…å®¹ç¢ºèª
plutil -p ~/Library/LaunchAgents/com.hovix.prism.classify.120s.plist
```

### ãƒ­ã‚°ç¢ºèª

```bash
# ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ­ã‚°
tail -f /Users/hal1956/development/PRISM/logs/classify_120s_*.log

# æœ€æ–°ã®ãƒ­ã‚°
ls -lt /Users/hal1956/development/PRISM/logs/classify_120s_*
```

---

## ğŸ”§ ç®¡ç†ã‚³ãƒãƒ³ãƒ‰

### ã‚µãƒ¼ãƒ“ã‚¹åˆ¶å¾¡

```bash
# åœæ­¢
launchctl unload ~/Library/LaunchAgents/com.hovix.prism.classify.120s.plist

# å†é–‹
launchctl load ~/Library/LaunchAgents/com.hovix.prism.classify.120s.plist

# å‰Šé™¤
launchctl unload ~/Library/LaunchAgents/com.hovix.prism.classify.120s.plist
rm ~/Library/LaunchAgents/com.hovix.prism.classify.120s.plist
```

### æ‰‹å‹•å®Ÿè¡Œ

```bash
cd /Users/hal1956/development/PRISM
python3 tools/advanced_classify_inbox.py
```

### é–“éš”å¤‰æ›´

```bash
# ä»–ã®é–“éš”ã«å¤‰æ›´
bash tools/change_interval.sh

# é¸æŠè‚¢:
# 1) 60ç§’é–“éš”ï¼ˆ1åˆ†ãŠãï¼‰
# 2) 120ç§’é–“éš”ï¼ˆ2åˆ†ãŠãï¼‰â† ç¾åœ¨
# 3) 300ç§’é–“éš”ï¼ˆ5åˆ†ãŠãï¼‰
# 4) 600ç§’é–“éš”ï¼ˆ10åˆ†ãŠãï¼‰
# 5) 1800ç§’é–“éš”ï¼ˆ30åˆ†ãŠãï¼‰
# 6) ã‚«ã‚¹ã‚¿ãƒ é–“éš”
# 0) åœæ­¢
```

---

## ğŸ“ˆ å®Ÿè¡Œé »åº¦ã®æ¯”è¼ƒ

| é–“éš” | 1æ™‚é–“ã‚ãŸã‚Š | 1æ—¥ã‚ãŸã‚Š | ç”¨é€” |
|------|------------|----------|------|
| 60ç§’ | 60å› | 1,440å› | æœ€é«˜é »åº¦ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰ |
| **120ç§’** | **30å›** | **720å›** | **é«˜é »åº¦ï¼ˆæ¨å¥¨ï¼‰** |
| 300ç§’ | 12å› | 288å› | ä¸­é »åº¦ |
| 600ç§’ | 6å› | 144å› | ä½é »åº¦ |
| 1800ç§’ | 2å› | 48å› | æœ€ä½é »åº¦ |

---

## âš ï¸ æ³¨æ„äº‹é …

### API ãƒ¬ãƒ¼ãƒˆåˆ¶é™

- **Notion API**: 3ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ç§’
- **OpenAI API**: åˆ¶é™ã‚ã‚Šï¼ˆãƒ—ãƒ©ãƒ³ã«ã‚ˆã‚‹ï¼‰
- **120ç§’é–“éš”**: å®‰å…¨ãªé–“éš”

### ãƒ­ã‚°ç®¡ç†

```bash
# å¤ã„ãƒ­ã‚°ã‚’å‰Šé™¤ï¼ˆ30æ—¥ä»¥ä¸Šå‰ï¼‰
find /Users/hal1956/development/PRISM/logs -name "classify_120s_*.log" -mtime +30 -delete

# ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆcronã§è‡ªå‹•åŒ–ï¼‰
0 0 * * 0 find /Users/hal1956/development/PRISM/logs -name "*.log" -mtime +30 -delete
```

### ã‚·ã‚¹ãƒ†ãƒ è² è·

- **CPUä½¿ç”¨ç‡**: ä½ï¼ˆ2åˆ†ã«1å›ã®çŸ­æ™‚é–“å®Ÿè¡Œï¼‰
- **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡**: æœ€å°é™
- **ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨é‡**: ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿

---

## ğŸ¯ é‹ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: å¸¸æ™‚å®Ÿè¡Œ

```bash
# 24æ™‚é–“365æ—¥å®Ÿè¡Œ
# è¨­å®š: 120ç§’é–“éš”
# ç”¨é€”: ãƒãƒ¼ãƒ å…±æœ‰ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ•´ç†
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: å–¶æ¥­æ™‚é–“ã®ã¿

```bash
# å¹³æ—¥ 9:00-18:00 ã®ã¿å®Ÿè¡Œ
# è¨­å®š: 120ç§’é–“éš” + æ™‚é–“åˆ¶é™
# ç”¨é€”: å€‹äººåˆ©ç”¨ã€æ¥­å‹™æ™‚é–“ã®ã¿
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: å‹•çš„èª¿æ•´

```bash
# æ™‚é–“å¸¯ã«ã‚ˆã£ã¦é–“éš”ã‚’å¤‰æ›´
# æœ: 120ç§’é–“éš”ï¼ˆé«˜é »åº¦ï¼‰
# å¤œ: 600ç§’é–“éš”ï¼ˆä½é »åº¦ï¼‰
# ç”¨é€”: åŠ¹ç‡çš„ãªé‹ç”¨
```

---

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### âŒ å®Ÿè¡Œã•ã‚Œãªã„

```bash
# 1. ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ç¢ºèª
launchctl list | grep prism

# 2. ãƒ­ã‚°ç¢ºèª
tail -f /Users/hal1956/development/PRISM/logs/classify_120s_err.log

# 3. æ‰‹å‹•å®Ÿè¡Œãƒ†ã‚¹ãƒˆ
cd /Users/hal1956/development/PRISM
python3 tools/advanced_classify_inbox.py

# 4. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª
plutil -lint ~/Library/LaunchAgents/com.hovix.prism.classify.120s.plist
```

### âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ

```bash
# ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç¢ºèª
grep -i error /Users/hal1956/development/PRISM/logs/classify_120s_*.log

# ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼:
# - API_KEY ã‚¨ãƒ©ãƒ¼ â†’ .env ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
# - Permission denied â†’ ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™ã‚’ç¢ºèª
# - Python not found â†’ python3 ã®ãƒ‘ã‚¹ã‚’ç¢ºèª
```

### âŒ é–“éš”ãŒæ­£ã—ããªã„

```bash
# è¨­å®šã‚’å†ç¢ºèª
plutil -extract StartInterval raw ~/Library/LaunchAgents/com.hovix.prism.classify.120s.plist

# å†è¨­å®š
bash tools/change_interval.sh
```

---

## ğŸ“š é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ« | ç”¨é€” |
|---------|------|
| `tools/setup_120s_interval.sh` | 120ç§’é–“éš”å°‚ç”¨è¨­å®š |
| `tools/change_interval.sh` | é–“éš”å¤‰æ›´ã‚¹ã‚¯ãƒªãƒ—ãƒˆ |
| `tools/setup_auto_classify_interval.sh` | cronç‰ˆè¨­å®š |
| `tools/advanced_classify_inbox.py` | ä»•åˆ†ã‘å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ |
| `docs/AUTOMATION_GUIDE.md` | è©³ç´°ã‚¬ã‚¤ãƒ‰ |

---

## ğŸ‰ ã¾ã¨ã‚

### âœ… 120ç§’é–“éš”è¨­å®šå®Œäº†

- **å®Ÿè¡Œé–“éš”**: 120ç§’ï¼ˆ2åˆ†ãŠãï¼‰
- **è¨­å®šæ–¹æ³•**: launchd
- **ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«**: `classify_120s_*.log`
- **ç®¡ç†**: `bash tools/change_interval.sh`

### ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **å‹•ä½œç¢ºèª**: æ•°æ™‚é–“æ§˜å­ã‚’è¦‹ã‚‹
2. **ãƒ­ã‚°ç¢ºèª**: ã‚¨ãƒ©ãƒ¼ãŒãªã„ã‹ãƒã‚§ãƒƒã‚¯
3. **é–“éš”èª¿æ•´**: å¿…è¦ã«å¿œã˜ã¦å¤‰æ›´
4. **é‹ç”¨é–‹å§‹**: æœ¬æ ¼é‹ç”¨

**120ç§’é–“éš”ã§ã€INBOXãŒå¸¸ã«æ•´ç†ã•ã‚ŒãŸçŠ¶æ…‹ã‚’ç¶­æŒã§ãã¾ã™ï¼** â°âœ¨

---

**è¨­å®šæ—¥**: 2025å¹´10æœˆ23æ—¥  
**é–“éš”**: 120ç§’ï¼ˆ2åˆ†ï¼‰  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè¡Œä¸­

